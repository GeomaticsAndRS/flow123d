flow123d_version: 1.8.9
problem: !Coupling_Sequential
  description: "Example 3 - Fractures - difusion"
  mesh:
    mesh_file: ./input/ex3_mesh.msh
    regions:
      - !Union
        name: flow_fractures
        regions:
          - flow_fracture1
          - flow_fracture2
      - !Union
        name: blind_fractures
        regions:
          - blind_fracture1
          - blind_fracture2
      - !Union
        name: BC_right
        regions:
          - .right
          - .right_points
      - !Union
        name: BC_left
        regions:
          - .left
          - .left_points
  # end mesh
  flow_equation: !Flow_Darcy_MH
    nonlinear_solver:
      linear_solver: !Petsc
        a_tol: 1.0e-15
        r_tol: 1.0e-15
    input_fields:
    - region: rock
      conductivity: 0.0315
      cross_section: 1
    - region: flow_fractures
      conductivity: 31.5
      cross_section: 0.01
    - region: blind_fractures
      conductivity: 3.15
      cross_section: 0.01
    - region: BC_left
      bc_type: dirichlet
      bc_piezo_head: 0.1
    - region: BC_right
      bc_type: dirichlet
      bc_piezo_head: 0
    balance: true
    output:
      output_stream:
        file: ./proudeni.msh
        format: !gmsh
          variant: ascii
      output_fields:
      - piezo_head_p0
      - pressure_p0
      - pressure_p1
      - velocity_p0
    solver: !Petsc
      r_tol: 1.0e-10
      a_tol: 1.0e-10
  # end primary equation
  solute_equation: !Coupling_OperatorSplitting
    transport: !Solute_AdvectionDiffusion_DG
      input_fields:
      - region: rock
        init_conc: 0
        porosity: 0.005
        diff_m: 0.0369
        disp_l: 5
        disp_t: 0.5
      - region: flow_fractures
        init_conc: 0
        porosity: 0.1
        diff_m: 0.0369
        disp_l: 5
        disp_t: 0.5
      - region: blind_fractures
        init_conc: 0
        porosity: 0.1
        diff_m: 0.0369
        disp_l: 5
        disp_t: 0.5
      - region: .left_points
        bc_type: dirichlet
        bc_conc: !FieldFormula
          value: (2.84959e-5)*exp(-(t-2000)^2/980000)
      solver: !Petsc
        a_tol: 1.0e-12
        r_tol: 1.0e-12
    substances:
      - I
    time:
      end_time: 50000
      init_dt: 10
    balance:
        cumulative: true
    output_stream:
      file: ./transport.pvd
      format: !vtk
        variant: ascii
      time_step: 500
  # end secondary equation
# end problem