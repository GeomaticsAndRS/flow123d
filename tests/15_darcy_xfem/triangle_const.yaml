flow123d_version: 2.0.0_rc
problem: !Coupling_Sequential
  description: Test25 - Steady flow with xfem singular connection 1D-2D
  mesh:
    mesh_file: ./input/triangle_const_4.msh
    #regions:
      #- !From_Elements
        #name: source
        #id: 100
        #element_list:
          #- 219
  flow_equation: !Flow_Darcy_MH
    output_specific:
    nonlinear_solver:
      linear_solver: !Petsc
        r_tol: 1.0e-10
        a_tol: 1.0e-10
    n_schurs: 0
    use_xfem:
      use_xfem: true
      enrich_velocity: true
      enrich_pressure: false
      continuous_pu: false
      single: true
      #enr_radius_factor: 1.5
    input_fields:
      - region: aquifer
        anisotropy: 1
      #- region: well
        #anisotropy: 10
        #sigma: 2e5
        #cross_section: 0.02
      
      - region: .BOUNDARY
        bc_type: dirichlet
        bc_pressure: !FieldFormula
          #value: 0 + (100-0)/log(0.03/10) * log(((x-3.3)^2+(y-3.3)^2)^0.5 / 10) # const dir problem
          value: (0 - 100)/(1/(0.03*1)-log(0.03/10))*log(((x-3.3)^2+(y-3.3)^2)^0.5 / 10) # const sigma problem
          # value: -100/(1/(0.03*1)-log(0.03/10))*log(((x-0.3)^2+(y-0.3)^2)^0.5 / 10) 
      #- region: .well_top
        #bc_type: dirichlet
        #bc_pressure: !FieldFormula
          #value: 300
      #- region: .well_bottom
        #bc_type: dirichlet
        #bc_pressure: !FieldFormula
          #value: 200
    balance: {}
    output:
      fields:
        - pressure_p0
        - velocity_p0
        - velocity_enr
        - velocity_reg
    output_stream: 
      file: ./test25.pvd
      format: !vtk
        variant: ascii
      name: flow_output_stream
      output_mesh:
        max_level: 2
        refine_by_error: false
        error_control_field: pressure_p0