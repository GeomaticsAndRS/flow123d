<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OSD: fem3d/mesh3d.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>fem3d/mesh3d.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Finite element subroutines: mesh data structures</span>
<a name="l00002"></a>00002 <span class="comment">   Jan Stebel</span>
<a name="l00003"></a>00003 <span class="comment">*/</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="preprocessor">#ifndef _MESH3D_H__</span>
<a name="l00006"></a>00006 <span class="preprocessor"></span><span class="preprocessor">#define _MESH3D_H__</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include "ad.h"</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#define GMSH_LINE             1</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span><span class="preprocessor">#define GMSH_TRIANGLE         2</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span><span class="preprocessor">#define GMSH_TETRAHEDRON      4</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#define GMSH_QUAD_LINE        8</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#define GMSH_QUAD_TRIANGLE    9</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#define GMSH_QUAD_TETRAHEDRON 11</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#define GMSH_POINT            15</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 <span class="preprocessor">#define VTK_LINE               3</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#define VTK_TRIANGLE           5</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#define VTK_TETRA              10</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="preprocessor">#define VTK_QUAD_EDGE     21</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#define VTK_QUAD_TRIANGLE 22</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define VTK_QUAD_TETRA    24</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="keyword">const</span> <span class="keywordtype">int</span> VTK_QUAD_TETRA_NODE_ORDER[] = { 0, 1, 2, 3, 4, 5, 6, 7, 9, 8 };
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="keyword">using namespace </span>std;
<a name="l00036"></a>00036 
<a name="l00038"></a><a class="code" href="classCElement.html">00038</a> <span class="keyword">class </span><a class="code" href="classCElement.html">CElement</a>
<a name="l00039"></a>00039 {
<a name="l00040"></a>00040  <span class="keyword">public</span>:
<a name="l00041"></a><a class="code" href="classCElement.html#882aa72a9fe38dd8b26a92c1075094b9">00041</a>   <span class="keywordtype">int</span> <a class="code" href="classCElement.html#882aa72a9fe38dd8b26a92c1075094b9">nphysical</a>;  
<a name="l00042"></a><a class="code" href="classCElement.html#15353e90b360f431292b320cdd4d2bb4">00042</a>   <span class="keywordtype">int</span> <a class="code" href="classCElement.html#15353e90b360f431292b320cdd4d2bb4">ngeom</a>;      
<a name="l00043"></a><a class="code" href="classCElement.html#df16bc7d90b5641f3d27d91c073f95a6">00043</a>   <span class="keywordtype">int</span> <a class="code" href="classCElement.html#df16bc7d90b5641f3d27d91c073f95a6">npart</a>;      
<a name="l00044"></a>00044 };
<a name="l00045"></a>00045 
<a name="l00047"></a><a class="code" href="classCTetrahedron.html">00047</a> <span class="keyword">class </span><a class="code" href="classCTetrahedron.html">CTetrahedron</a> : <span class="keyword">public</span> <a class="code" href="classCElement.html">CElement</a>
<a name="l00048"></a>00048 {
<a name="l00049"></a>00049  <span class="keyword">public</span>:
<a name="l00050"></a><a class="code" href="classCTetrahedron.html#16c5d8adf8bdf1d4f507e19abd848136">00050</a>   <span class="keywordtype">int</span> <a class="code" href="classCTetrahedron.html#16c5d8adf8bdf1d4f507e19abd848136">nodes</a>[4]; 
<a name="l00051"></a>00051 };
<a name="l00052"></a>00052 
<a name="l00054"></a><a class="code" href="classCQuadTetrahedron.html">00054</a> <span class="keyword">class </span><a class="code" href="classCQuadTetrahedron.html">CQuadTetrahedron</a> : <span class="keyword">public</span> <a class="code" href="classCElement.html">CElement</a>
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056  <span class="keyword">public</span>:
<a name="l00057"></a><a class="code" href="classCQuadTetrahedron.html#972ec9116d48e4c89eb65db619cd755a">00057</a>   <span class="keywordtype">int</span> <a class="code" href="classCQuadTetrahedron.html#972ec9116d48e4c89eb65db619cd755a">nodes</a>[10]; 
<a name="l00058"></a>00058 };
<a name="l00059"></a>00059 
<a name="l00061"></a><a class="code" href="classCTriangle.html">00061</a> <span class="keyword">class </span><a class="code" href="classCTriangle.html">CTriangle</a> : <span class="keyword">public</span> <a class="code" href="classCElement.html">CElement</a>
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063  <span class="keyword">public</span>:
<a name="l00064"></a><a class="code" href="classCTriangle.html#ebdb8ce805434c559a62ca12cf0a528c">00064</a>   <span class="keywordtype">int</span> <a class="code" href="classCTriangle.html#ebdb8ce805434c559a62ca12cf0a528c">nodes</a>[3]; 
<a name="l00065"></a>00065 };
<a name="l00066"></a>00066 
<a name="l00068"></a><a class="code" href="classCQuadTriangle.html">00068</a> <span class="keyword">class </span><a class="code" href="classCQuadTriangle.html">CQuadTriangle</a> : <span class="keyword">public</span> <a class="code" href="classCElement.html">CElement</a>
<a name="l00069"></a>00069 {
<a name="l00070"></a>00070  <span class="keyword">public</span>:
<a name="l00071"></a><a class="code" href="classCQuadTriangle.html#5ed56fa3c13b51f9825d4aa2d204db43">00071</a>   <span class="keywordtype">int</span> <a class="code" href="classCQuadTriangle.html#5ed56fa3c13b51f9825d4aa2d204db43">nodes</a>[6]; 
<a name="l00072"></a>00072 };
<a name="l00073"></a>00073 
<a name="l00075"></a><a class="code" href="classCLine.html">00075</a> <span class="keyword">class </span><a class="code" href="classCLine.html">CLine</a> : <span class="keyword">public</span> <a class="code" href="classCElement.html">CElement</a>
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077  <span class="keyword">public</span>:
<a name="l00078"></a><a class="code" href="classCLine.html#0bf450722ce8ec6fc060852a251bfdea">00078</a>   <span class="keywordtype">int</span> <a class="code" href="classCLine.html#0bf450722ce8ec6fc060852a251bfdea">nodes</a>[2]; 
<a name="l00079"></a>00079 };
<a name="l00080"></a>00080 
<a name="l00082"></a><a class="code" href="classCQuadLine.html">00082</a> <span class="keyword">class </span><a class="code" href="classCQuadLine.html">CQuadLine</a> : <span class="keyword">public</span> <a class="code" href="classCElement.html">CElement</a>
<a name="l00083"></a>00083 {
<a name="l00084"></a>00084  <span class="keyword">public</span>:
<a name="l00085"></a><a class="code" href="classCQuadLine.html#a0da931066560b4d43ccdd37dad667af">00085</a>   <span class="keywordtype">int</span> <a class="code" href="classCQuadLine.html#a0da931066560b4d43ccdd37dad667af">nodes</a>[3]; 
<a name="l00086"></a>00086 };
<a name="l00087"></a>00087 
<a name="l00089"></a><a class="code" href="classC3DMesh.html">00089</a> <span class="keyword">class </span><a class="code" href="classC3DMesh.html">C3DMesh</a>
<a name="l00090"></a>00090 {
<a name="l00091"></a>00091  <span class="keyword">protected</span>:
<a name="l00092"></a><a class="code" href="classC3DMesh.html#86b04006c46e2bc305c658a2bf5ee52d">00092</a>   vector&lt;CVar&gt;    <a class="code" href="classC3DMesh.html#86b04006c46e2bc305c658a2bf5ee52d">coords</a>;        
<a name="l00093"></a><a class="code" href="classC3DMesh.html#f7b32d6d9e1054b9d264047548939294">00093</a>   map&lt;int,string&gt; <a class="code" href="classC3DMesh.html#f7b32d6d9e1054b9d264047548939294">physicalNames</a>; 
<a name="l00094"></a><a class="code" href="classC3DMesh.html#7d962c354bea852abe2efdd30311a955">00094</a>   map&lt;string,int&gt; <a class="code" href="classC3DMesh.html#7d962c354bea852abe2efdd30311a955">physNameIds</a>;   
<a name="l00096"></a><a class="code" href="classC3DMesh.html#ad4511d6f28926a9e3b0295254d4b11d">00096</a>   <span class="keywordtype">int</span>     <a class="code" href="classC3DMesh.html#ad4511d6f28926a9e3b0295254d4b11d">nnodes</a>;    
<a name="l00097"></a><a class="code" href="classC3DMesh.html#efaf1c06a1c4274d3b4f66f6e15e0eae">00097</a>   <span class="keywordtype">int</span>     <a class="code" href="classC3DMesh.html#efaf1c06a1c4274d3b4f66f6e15e0eae">nedges</a>;    
<a name="l00098"></a><a class="code" href="classC3DMesh.html#fa761608cc067ff4cf1977a639a66e60">00098</a>   <span class="keywordtype">int</span>     <a class="code" href="classC3DMesh.html#fa761608cc067ff4cf1977a639a66e60">nfaces</a>;    
<a name="l00099"></a><a class="code" href="classC3DMesh.html#87f3bd639ac113804982203d7e829884">00099</a>   <span class="keywordtype">int</span>     <a class="code" href="classC3DMesh.html#87f3bd639ac113804982203d7e829884">nvolumes</a>;  
<a name="l00101"></a>00101  <span class="keyword">public</span>:
<a name="l00103"></a><a class="code" href="classC3DMesh.html#e728fa14cceff48176006f6c6100e73d">00103</a>   <a class="code" href="classC3DMesh.html#e728fa14cceff48176006f6c6100e73d">C3DMesh</a>() {};
<a name="l00104"></a>00104   
<a name="l00106"></a>00106   <span class="keyword">virtual</span> <a class="code" href="classC3DMesh.html#0112f13a0142d45a864bd08b88324c47">~C3DMesh</a>();
<a name="l00107"></a>00107   
<a name="l00109"></a>00109   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classC3DMesh.html#b30237e36913559efdca59b887a5d337">destroy</a>();
<a name="l00110"></a>00110   
<a name="l00115"></a>00115   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classC3DMesh.html#0d9ddbeb876b4907d5abcdb424bb878c">readGMSH</a> (string fname) = 0;
<a name="l00116"></a>00116   
<a name="l00121"></a>00121   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classC3DMesh.html#c897d09d9e2f841501ffb3dea001d419">writeGMSH</a>(string fname) = 0;
<a name="l00122"></a>00122   
<a name="l00128"></a>00128   <span class="keywordtype">void</span>         <a class="code" href="classC3DMesh.html#1a6a0aed8b015f51d9cde908d1381263">deform</a>(<a class="code" href="classCVar.html">CVar</a>&amp; func(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">int</span> comp));
<a name="l00129"></a>00129   
<a name="l00135"></a>00135   <a class="code" href="classCVar.html">CVar</a>&amp; <a class="code" href="classC3DMesh.html#8a46f4408e0897c7ce8239727b0edde9">getCoord</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span> coord);
<a name="l00136"></a>00136   
<a name="l00143"></a>00143   <span class="keywordtype">void</span>  <a class="code" href="classC3DMesh.html#a10c9b8e9e047513a42487c76017024b">setCoord</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span> coord, <a class="code" href="classCVar.html">CVar</a> x);
<a name="l00144"></a>00144   
<a name="l00146"></a><a class="code" href="classC3DMesh.html#4f6cb601729bbc4195dbe9ee4c9b6276">00146</a>   <span class="keywordtype">int</span>    <a class="code" href="classC3DMesh.html#4f6cb601729bbc4195dbe9ee4c9b6276">getNphysicalNames</a>()    { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#f7b32d6d9e1054b9d264047548939294">physicalNames</a>.size(); }
<a name="l00147"></a>00147   
<a name="l00152"></a><a class="code" href="classC3DMesh.html#61d3d858b2b993b34f7e8a7cca27a8f8">00152</a>   string <a class="code" href="classC3DMesh.html#61d3d858b2b993b34f7e8a7cca27a8f8">getPhysicalName</a>(<span class="keywordtype">int</span> n) { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#f7b32d6d9e1054b9d264047548939294">physicalNames</a>[n];     }
<a name="l00153"></a>00153   
<a name="l00158"></a><a class="code" href="classC3DMesh.html#654fed0918b74f69a7690d73825da72a">00158</a>   <span class="keywordtype">int</span>    <a class="code" href="classC3DMesh.html#654fed0918b74f69a7690d73825da72a">getPhysNameId</a>(string name) { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#7d962c354bea852abe2efdd30311a955">physNameIds</a>[name]; }
<a name="l00159"></a>00159   
<a name="l00161"></a><a class="code" href="classC3DMesh.html#b31636b44f1aa5f0c88bc4ece4a5dd02">00161</a>   map&lt;int,string&gt;::iterator <a class="code" href="classC3DMesh.html#b31636b44f1aa5f0c88bc4ece4a5dd02">beginPhysicalNames</a>() { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#f7b32d6d9e1054b9d264047548939294">physicalNames</a>.begin(); }
<a name="l00162"></a>00162   
<a name="l00164"></a><a class="code" href="classC3DMesh.html#79e74ef52d876acf7df185ba80e216b3">00164</a>   map&lt;int,string&gt;::iterator <a class="code" href="classC3DMesh.html#79e74ef52d876acf7df185ba80e216b3">endPhysicalNames</a>() { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#f7b32d6d9e1054b9d264047548939294">physicalNames</a>.end(); }
<a name="l00165"></a>00165   
<a name="l00173"></a>00173   <span class="keywordtype">void</span>   <a class="code" href="classC3DMesh.html#8f42b75ef11d5fed8a3fc6358146f401">calculateFaceNormal</a>(<span class="keywordtype">int</span> fid, CVec &amp;n, CVec &amp;t1, CVec &amp;t2);
<a name="l00174"></a>00174   
<a name="l00180"></a>00180   <span class="keywordtype">void</span>   <a class="code" href="classC3DMesh.html#c0aff6808bffc2e84a1f849b41d705a2">calculateEdgeTangent</a>(<span class="keywordtype">int</span> eid, CVec &amp;t);
<a name="l00181"></a>00181   
<a name="l00183"></a><a class="code" href="classC3DMesh.html#cb81c11df24c991dbd6ea1077f7d1946">00183</a>   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#cb81c11df24c991dbd6ea1077f7d1946">getNnodes</a>()     { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#ad4511d6f28926a9e3b0295254d4b11d">nnodes</a>; }
<a name="l00184"></a>00184   
<a name="l00186"></a><a class="code" href="classC3DMesh.html#01383b7d85144a5b627d520d1306d7d5">00186</a>   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#01383b7d85144a5b627d520d1306d7d5">getNlnodes</a>()    { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#ad4511d6f28926a9e3b0295254d4b11d">nnodes</a>; }
<a name="l00187"></a>00187   
<a name="l00189"></a><a class="code" href="classC3DMesh.html#cabe1b03d7401f0ca68128260477b840">00189</a>   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#cabe1b03d7401f0ca68128260477b840">getNedges</a>()     { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#efaf1c06a1c4274d3b4f66f6e15e0eae">nedges</a>; }
<a name="l00190"></a>00190   
<a name="l00192"></a><a class="code" href="classC3DMesh.html#c3d33453c7188355b99a1f1f3f5299fb">00192</a>   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#c3d33453c7188355b99a1f1f3f5299fb">getNfaces</a>()     { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#fa761608cc067ff4cf1977a639a66e60">nfaces</a>; }
<a name="l00193"></a>00193   
<a name="l00195"></a><a class="code" href="classC3DMesh.html#9a2fbba492b16ff53c7f98beeb5ca037">00195</a>   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#9a2fbba492b16ff53c7f98beeb5ca037">getNvolumes</a>()   { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#87f3bd639ac113804982203d7e829884">nvolumes</a>; }
<a name="l00196"></a>00196 
<a name="l00201"></a>00201   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#180b567ad659dbc1281f61d994092902">getVolumePhysicalNo</a>(<span class="keywordtype">int</span> v) = 0;
<a name="l00202"></a>00202   
<a name="l00207"></a>00207   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#ecee50d6768f5aefb7d2d0f13f79a3ae">getFacePhysicalNo</a>  (<span class="keywordtype">int</span> f) = 0;
<a name="l00208"></a>00208   
<a name="l00213"></a>00213   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#c802c0125acf518ba01000d158394cab">getEdgePhysicalNo</a>  (<span class="keywordtype">int</span> e) = 0;
<a name="l00214"></a>00214   
<a name="l00219"></a>00219   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#1ede4b35e082016f27bf9c226bc82bbc">getVolumeGeomNo</a>(<span class="keywordtype">int</span> v) = 0;
<a name="l00220"></a>00220   
<a name="l00225"></a>00225   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#b29024c0183bc1aeefefe57c3c64c6ec">getFaceGeomNo</a>  (<span class="keywordtype">int</span> f) = 0;
<a name="l00226"></a>00226   
<a name="l00231"></a>00231   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#8c2a8337ef699148423ca4040678db47">getEdgeGeomNo</a>  (<span class="keywordtype">int</span> e) = 0;
<a name="l00232"></a>00232   
<a name="l00237"></a>00237   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#d92cc34c21439dbb6f8e68767cbcf09d">getVolumePartNo</a>(<span class="keywordtype">int</span> v) = 0;
<a name="l00238"></a>00238   
<a name="l00243"></a>00243   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#54f8edd5805a89303d6ba20bd90145ae">getFacePartNo</a>  (<span class="keywordtype">int</span> f) = 0;
<a name="l00244"></a>00244   
<a name="l00249"></a>00249   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#307e77ca93d218d9ee7e2ac47b27d2d2">getEdgePartNo</a>  (<span class="keywordtype">int</span> e) = 0;
<a name="l00250"></a>00250   
<a name="l00257"></a>00257   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#c16776a278f9403dc02e483ff43c4049">getVolumeNode</a>(<span class="keywordtype">int</span> volume, <span class="keywordtype">int</span> node) = 0;
<a name="l00264"></a>00264   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#495f8b143508d2cd6befeeb7774c0330">getFaceNode</a>  (<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> node)   = 0;
<a name="l00265"></a>00265   
<a name="l00271"></a>00271   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#4e30857336ed8fef483654e60e49d2c2">getEdgeNode</a>  (<span class="keywordtype">int</span> edge, <span class="keywordtype">int</span> node)   = 0;
<a name="l00272"></a>00272   
<a name="l00274"></a>00274   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#408dcca9e9ac9d67509ea9114f6b2751">getNvolumeDofs</a>() = 0;
<a name="l00275"></a>00275   
<a name="l00277"></a>00277   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#d0be26843923dd3c23f2deaf6cc9ae2c">getNfaceDofs</a>()   = 0;
<a name="l00278"></a>00278   
<a name="l00280"></a>00280   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#b340ec6c3a5d5e4acbdc5dbc43a0d50b">getNedgeDofs</a>()   = 0;
<a name="l00281"></a>00281   
<a name="l00283"></a>00283   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#cd76022e68852cdd17a025c61b4c9f96">getVtk3Dtype</a>() = 0;
<a name="l00284"></a>00284   
<a name="l00286"></a>00286   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#40c10858c8107a49bda1743a628bedb9">getVtk2Dtype</a>() = 0;
<a name="l00287"></a>00287   
<a name="l00289"></a>00289   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#157c52f8c0df7cc5c3c584214e64fe98">getVtk1Dtype</a>() = 0;
<a name="l00290"></a>00290   
<a name="l00296"></a><a class="code" href="classC3DMesh.html#e90f1484d4607c13e8a874cfb11cfdcc">00296</a>   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classC3DMesh.html#e90f1484d4607c13e8a874cfb11cfdcc">getVtkVolumeNode</a>(<span class="keywordtype">int</span> volume, <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> <a class="code" href="classC3DMesh.html#c16776a278f9403dc02e483ff43c4049">getVolumeNode</a>(volume, node); }
<a name="l00297"></a>00297   
<a name="l00298"></a>00298 <span class="comment">//  virtual CVar getFaceSize(int face) = 0;</span>
<a name="l00299"></a>00299 <span class="comment">//  virtual CVar getElemSize(int ind);</span>
<a name="l00300"></a>00300 <span class="comment">//  virtual CVar getElemDiam(int ind);</span>
<a name="l00301"></a>00301   
<a name="l00302"></a>00302 };
<a name="l00303"></a>00303 
<a name="l00304"></a>00304 
<a name="l00306"></a><a class="code" href="classC3DLinMesh.html">00306</a> <span class="keyword">class </span><a class="code" href="classC3DLinMesh.html">C3DLinMesh</a> : <span class="keyword">public</span> <a class="code" href="classC3DMesh.html">C3DMesh</a>
<a name="l00307"></a>00307 {
<a name="l00308"></a>00308  <span class="keyword">private</span>:
<a name="l00309"></a>00309   vector&lt;CTetrahedron&gt; volumes;
<a name="l00310"></a>00310   vector&lt;CTriangle&gt;    faces;
<a name="l00311"></a>00311   vector&lt;CLine&gt;        edges;
<a name="l00312"></a>00312   
<a name="l00313"></a>00313  <span class="keyword">public</span>:
<a name="l00314"></a>00314   ~<a class="code" href="classC3DLinMesh.html">C3DLinMesh</a>();
<a name="l00315"></a>00315  
<a name="l00316"></a>00316   <span class="keywordtype">void</span> <a class="code" href="classC3DLinMesh.html#804290a280f29d6da8339526655033e2">readGMSH</a>(string fname);
<a name="l00317"></a><a class="code" href="classC3DLinMesh.html#c566d2e74e021733106f637fa9561ff7">00317</a>   <span class="keywordtype">void</span> <a class="code" href="classC3DLinMesh.html#c566d2e74e021733106f637fa9561ff7">writeGMSH</a>(string fname) {}
<a name="l00318"></a>00318   <span class="keywordtype">void</span> splitBoundaryVolumes();
<a name="l00319"></a>00319   
<a name="l00320"></a><a class="code" href="classC3DLinMesh.html#a272b655d834916b6d2a9a64058b31f5">00320</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#a272b655d834916b6d2a9a64058b31f5">getVolumePhysicalNo</a>(<span class="keywordtype">int</span> v) { <span class="keywordflow">return</span> volumes[v].nphysical; }
<a name="l00321"></a><a class="code" href="classC3DLinMesh.html#ad675e2bfa9f3be539e8c951d41f8711">00321</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#ad675e2bfa9f3be539e8c951d41f8711">getFacePhysicalNo</a>  (<span class="keywordtype">int</span> f) { <span class="keywordflow">return</span> faces[f].nphysical;   }
<a name="l00322"></a><a class="code" href="classC3DLinMesh.html#09ce32ec080c02ed2fc70dab80220c83">00322</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#09ce32ec080c02ed2fc70dab80220c83">getEdgePhysicalNo</a>  (<span class="keywordtype">int</span> e) { <span class="keywordflow">return</span> edges[e].nphysical;   }
<a name="l00323"></a>00323   
<a name="l00324"></a><a class="code" href="classC3DLinMesh.html#d2129489dce61dde861b211a28b1a021">00324</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#d2129489dce61dde861b211a28b1a021">getVolumeGeomNo</a>(<span class="keywordtype">int</span> v) { <span class="keywordflow">return</span> volumes[v].ngeom; }
<a name="l00325"></a><a class="code" href="classC3DLinMesh.html#7383617aa84ef3f9c2f5e8e9059208e2">00325</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#7383617aa84ef3f9c2f5e8e9059208e2">getFaceGeomNo</a>  (<span class="keywordtype">int</span> f) { <span class="keywordflow">return</span> faces[f].ngeom;   }
<a name="l00326"></a><a class="code" href="classC3DLinMesh.html#a302617a230b390f847ab4679b28b601">00326</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#a302617a230b390f847ab4679b28b601">getEdgeGeomNo</a>  (<span class="keywordtype">int</span> e) { <span class="keywordflow">return</span> edges[e].ngeom;   }
<a name="l00327"></a>00327   
<a name="l00328"></a><a class="code" href="classC3DLinMesh.html#9b5a64ca0e2a24c6f6b97324f289edf9">00328</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#9b5a64ca0e2a24c6f6b97324f289edf9">getVolumePartNo</a>(<span class="keywordtype">int</span> v) { <span class="keywordflow">return</span> volumes[v].npart; }
<a name="l00329"></a><a class="code" href="classC3DLinMesh.html#27784125f75730bb02cf30155399ec8d">00329</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#27784125f75730bb02cf30155399ec8d">getFacePartNo</a>  (<span class="keywordtype">int</span> f) { <span class="keywordflow">return</span> faces[f].npart;   }
<a name="l00330"></a><a class="code" href="classC3DLinMesh.html#c0864af71da4005d1f57350708edb0ce">00330</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#c0864af71da4005d1f57350708edb0ce">getEdgePartNo</a>  (<span class="keywordtype">int</span> e) { <span class="keywordflow">return</span> edges[e].npart;   }
<a name="l00331"></a>00331   
<a name="l00332"></a><a class="code" href="classC3DLinMesh.html#a30f71f407fe3c55e8e24023c5bbfaea">00332</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#a30f71f407fe3c55e8e24023c5bbfaea">getVolumeNode</a>(<span class="keywordtype">int</span> volume, <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> volumes[volume].nodes[node]; }
<a name="l00333"></a><a class="code" href="classC3DLinMesh.html#b37a41cba97b3930ad60daad69f25b30">00333</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#b37a41cba97b3930ad60daad69f25b30">getFaceNode</a>  (<span class="keywordtype">int</span> face,   <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> faces[face].nodes[node]; }
<a name="l00334"></a><a class="code" href="classC3DLinMesh.html#9e2cddf151711c5a10e72a0ed2f57c10">00334</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#9e2cddf151711c5a10e72a0ed2f57c10">getEdgeNode</a>  (<span class="keywordtype">int</span> edge,   <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> edges[edge].nodes[node]; }
<a name="l00335"></a>00335   
<a name="l00336"></a><a class="code" href="classC3DLinMesh.html#2a6e0f46b4822222cf67280f4e53bc86">00336</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#2a6e0f46b4822222cf67280f4e53bc86">getNvolumeDofs</a>() { <span class="keywordflow">return</span> 4; }
<a name="l00337"></a><a class="code" href="classC3DLinMesh.html#599e5e56902dd30933dfc633978f4bff">00337</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#599e5e56902dd30933dfc633978f4bff">getNfaceDofs</a>()   { <span class="keywordflow">return</span> 3; }
<a name="l00338"></a><a class="code" href="classC3DLinMesh.html#25a6dbd8d00cb05f382b212981b698e9">00338</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#25a6dbd8d00cb05f382b212981b698e9">getNedgeDofs</a>()   { <span class="keywordflow">return</span> 2; }
<a name="l00339"></a>00339   
<a name="l00340"></a><a class="code" href="classC3DLinMesh.html#5104961f1c4af0bcb33dfd27b70802c8">00340</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#5104961f1c4af0bcb33dfd27b70802c8">getVtk3Dtype</a>() { <span class="keywordflow">return</span> VTK_TETRA; }
<a name="l00341"></a><a class="code" href="classC3DLinMesh.html#628de43df2fa446c4a88bdbdbd5e3de5">00341</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#628de43df2fa446c4a88bdbdbd5e3de5">getVtk2Dtype</a>() { <span class="keywordflow">return</span> VTK_TRIANGLE; }
<a name="l00342"></a><a class="code" href="classC3DLinMesh.html#5d62deac65ac139bfc950c541410094d">00342</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DLinMesh.html#5d62deac65ac139bfc950c541410094d">getVtk1Dtype</a>() { <span class="keywordflow">return</span> VTK_LINE; }
<a name="l00343"></a>00343   
<a name="l00344"></a>00344 <span class="comment">//  CVar getFaceSize(int face) { return 0; }</span>
<a name="l00345"></a>00345   
<a name="l00346"></a>00346 };
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 
<a name="l00350"></a><a class="code" href="classC3DQuadMesh.html">00350</a> <span class="keyword">class </span><a class="code" href="classC3DQuadMesh.html">C3DQuadMesh</a> : <span class="keyword">public</span> <a class="code" href="classC3DMesh.html">C3DMesh</a>
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352  <span class="keyword">private</span>:
<a name="l00353"></a>00353   vector&lt;CQuadTetrahedron&gt; volumes;
<a name="l00354"></a>00354   vector&lt;CQuadTriangle&gt;    faces;
<a name="l00355"></a>00355   vector&lt;CQuadLine&gt;        edges;
<a name="l00356"></a>00356   
<a name="l00357"></a>00357   <span class="keywordtype">int</span> nlnodes;
<a name="l00358"></a>00358   vector&lt;int&gt; lnmap;
<a name="l00359"></a>00359   
<a name="l00360"></a>00360  <span class="keyword">public</span>:
<a name="l00361"></a>00361   ~<a class="code" href="classC3DQuadMesh.html">C3DQuadMesh</a>();
<a name="l00362"></a>00362  
<a name="l00363"></a>00363   <span class="keywordtype">void</span> <a class="code" href="classC3DQuadMesh.html#1f2917469e5a833cdbbb76e5d658f6e4">readGMSH</a> (string fname);
<a name="l00364"></a>00364   <span class="keywordtype">void</span> <a class="code" href="classC3DQuadMesh.html#1b72b6582da1305a0d992305fd1913ff">writeGMSH</a>(string fname);
<a name="l00365"></a>00365   <span class="keywordtype">void</span> splitBoundaryVolumes ();
<a name="l00366"></a>00366   
<a name="l00367"></a><a class="code" href="classC3DQuadMesh.html#4c845b1e31cd8dc323ccc2d087e7b2bd">00367</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#4c845b1e31cd8dc323ccc2d087e7b2bd">getVolumePhysicalNo</a>(<span class="keywordtype">int</span> v) { <span class="keywordflow">return</span> volumes[v].nphysical; }
<a name="l00368"></a><a class="code" href="classC3DQuadMesh.html#ea6f39237194e4e1ccc452accab61c76">00368</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#ea6f39237194e4e1ccc452accab61c76">getFacePhysicalNo</a>  (<span class="keywordtype">int</span> f) { <span class="keywordflow">return</span> faces[f].nphysical;   }
<a name="l00369"></a><a class="code" href="classC3DQuadMesh.html#bee7be0ee0e3708ad1f7a039ada48182">00369</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#bee7be0ee0e3708ad1f7a039ada48182">getEdgePhysicalNo</a>  (<span class="keywordtype">int</span> e) { <span class="keywordflow">return</span> edges[e].nphysical;   }
<a name="l00370"></a>00370   
<a name="l00371"></a><a class="code" href="classC3DQuadMesh.html#944202b9678064176f506cc69c63e43f">00371</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#944202b9678064176f506cc69c63e43f">getVolumeGeomNo</a>(<span class="keywordtype">int</span> v) { <span class="keywordflow">return</span> volumes[v].ngeom; }
<a name="l00372"></a><a class="code" href="classC3DQuadMesh.html#98b261368e1ec4ac7fe9cd558adbccdd">00372</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#98b261368e1ec4ac7fe9cd558adbccdd">getFaceGeomNo</a>  (<span class="keywordtype">int</span> f) { <span class="keywordflow">return</span> faces[f].ngeom;   }
<a name="l00373"></a><a class="code" href="classC3DQuadMesh.html#762c19c1aa9bd91fb6bddeca5d38c643">00373</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#762c19c1aa9bd91fb6bddeca5d38c643">getEdgeGeomNo</a>  (<span class="keywordtype">int</span> e) { <span class="keywordflow">return</span> edges[e].ngeom;   }
<a name="l00374"></a>00374   
<a name="l00375"></a><a class="code" href="classC3DQuadMesh.html#2de75e761813fed5bd017093ac16cc1b">00375</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#2de75e761813fed5bd017093ac16cc1b">getVolumePartNo</a>(<span class="keywordtype">int</span> v) { <span class="keywordflow">return</span> volumes[v].npart; }
<a name="l00376"></a><a class="code" href="classC3DQuadMesh.html#86f69b5fc80d89d559cf8783c8a44807">00376</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#86f69b5fc80d89d559cf8783c8a44807">getFacePartNo</a>  (<span class="keywordtype">int</span> f) { <span class="keywordflow">return</span> faces[f].npart;   }
<a name="l00377"></a><a class="code" href="classC3DQuadMesh.html#8b000770ed7c9e5ced439a2501bf91fd">00377</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#8b000770ed7c9e5ced439a2501bf91fd">getEdgePartNo</a>  (<span class="keywordtype">int</span> e) { <span class="keywordflow">return</span> edges[e].npart;   }
<a name="l00378"></a>00378   <span class="keywordtype">void</span> setVolumePartNo(<span class="keywordtype">int</span> v, <span class="keywordtype">int</span> no) { volumes[v].npart = no; }
<a name="l00379"></a>00379   <span class="keywordtype">void</span> setFacePartNo  (<span class="keywordtype">int</span> f, <span class="keywordtype">int</span> no) { faces[f].npart = no;   }
<a name="l00380"></a>00380   
<a name="l00381"></a><a class="code" href="classC3DQuadMesh.html#00c9f51f3af73458875c7812ffd62660">00381</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#00c9f51f3af73458875c7812ffd62660">getVolumeNode</a>(<span class="keywordtype">int</span> volume, <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> volumes[volume].nodes[node]; }
<a name="l00382"></a><a class="code" href="classC3DQuadMesh.html#aecc929f823f2dca773f439716f9cb9f">00382</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#aecc929f823f2dca773f439716f9cb9f">getFaceNode</a>  (<span class="keywordtype">int</span> face,   <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> faces[face].nodes[node]; }
<a name="l00383"></a><a class="code" href="classC3DQuadMesh.html#17e1fa33a51707d1921e26afb0fa9f4e">00383</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#17e1fa33a51707d1921e26afb0fa9f4e">getEdgeNode</a>  (<span class="keywordtype">int</span> edge,   <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> edges[edge].nodes[node]; }
<a name="l00384"></a>00384   
<a name="l00385"></a><a class="code" href="classC3DQuadMesh.html#58587975af722e70949a5826b248d65d">00385</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#58587975af722e70949a5826b248d65d">getNvolumeDofs</a>() { <span class="keywordflow">return</span> 10; }
<a name="l00386"></a><a class="code" href="classC3DQuadMesh.html#97ba926000cbdfd496cafd7e9fa975c1">00386</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#97ba926000cbdfd496cafd7e9fa975c1">getNfaceDofs</a>()   { <span class="keywordflow">return</span> 6; }
<a name="l00387"></a><a class="code" href="classC3DQuadMesh.html#0765b0120ff48a6862948bc10467753a">00387</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#0765b0120ff48a6862948bc10467753a">getNedgeDofs</a>()   { <span class="keywordflow">return</span> 3; }
<a name="l00388"></a>00388   
<a name="l00389"></a><a class="code" href="classC3DQuadMesh.html#c5993fd0909130808205a1291b891821">00389</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#c5993fd0909130808205a1291b891821">getNlnodes</a>() { <span class="keywordflow">return</span> nlnodes; }
<a name="l00390"></a>00390   <span class="keywordtype">int</span> getNoOfLnode(<span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> lnmap[node]; }  <span class="comment">// translate node no. within all nodes into linear node no.</span>
<a name="l00391"></a>00391   
<a name="l00392"></a><a class="code" href="classC3DQuadMesh.html#830a7e01e64d7f716f338822ae09209a">00392</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#830a7e01e64d7f716f338822ae09209a">getVtk3Dtype</a>() { <span class="keywordflow">return</span> VTK_QUAD_TETRA; }
<a name="l00393"></a><a class="code" href="classC3DQuadMesh.html#3d2f85fa37fd094907dc8ef75c1f6e92">00393</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#3d2f85fa37fd094907dc8ef75c1f6e92">getVtk2Dtype</a>() { <span class="keywordflow">return</span> VTK_QUAD_TRIANGLE; }
<a name="l00394"></a><a class="code" href="classC3DQuadMesh.html#b657d535cc1a8dec03a00696ec41819d">00394</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#b657d535cc1a8dec03a00696ec41819d">getVtk1Dtype</a>() { <span class="keywordflow">return</span> VTK_QUAD_EDGE; }
<a name="l00395"></a><a class="code" href="classC3DQuadMesh.html#43f1c491944d874cca27401434ef615e">00395</a>   <span class="keywordtype">int</span> <a class="code" href="classC3DQuadMesh.html#43f1c491944d874cca27401434ef615e">getVtkVolumeNode</a>(<span class="keywordtype">int</span> volume, <span class="keywordtype">int</span> node) { <span class="keywordflow">return</span> <a class="code" href="classC3DQuadMesh.html#00c9f51f3af73458875c7812ffd62660">getVolumeNode</a>(volume, VTK_QUAD_TETRA_NODE_ORDER[node]); }
<a name="l00396"></a>00396   
<a name="l00397"></a>00397 <span class="comment">//  CVar getFaceSize(int face) { return 0; }</span>
<a name="l00398"></a>00398   
<a name="l00399"></a>00399 };
<a name="l00400"></a>00400 
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <span class="preprocessor">#endif</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 16 13:07:44 2009 for OSD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
